# Fuzzy Control（模糊控制）

模糊控制是一种可以实现多输入单输出、多输入多输出的控制算法，它通常用于取代传统控制算法中的控制器（此处对应于多输入单输出，多输入得益于其前方的比较环节），从而在一定程度上综合利用各个输入条件。

# 控制器核心

以两个输入变量一个输出变量为例对模糊控制的控制器核心进行说明：

![控制器核心](./img/控制器核心.jpg)

$D/F$：将输入数据进行模糊化处理

$A^{*} \circ R$：进行控制规则模糊推理

$F/D$：将模糊数据转换成控制数据

经过以上单元，便将多输入数据处理成了控制数据，提供给后续的执行机构等部分。

# 专业名词

理解一些专业名词，能够使我们更加准确的理解模糊控制。

## 模糊控制器FC

由“$D/F$”、“$A^{*} \circ R$”和“$F/D$”组成的控制器就叫模糊控制器。

## 模糊子集

对一个变量的评价体系，如下面将提到的分数的评价体系。

## 隶属函数

输入变量映射到模糊子集的函数，模糊子集通常的取值区间为`[0, 1]`

## 模糊推理

## 反模糊化

# 相关数学符号说明

1. 模糊化运算符：$\circ$

# 具体过程

## 总体概括

通过模糊控制器按照一定的准则将输入的数据转换成模糊数据（一系列的向量），然后对这些模糊数据进行推理得到模糊控制信号，再反模糊化得到实际使用的控制信号。

### 编程建议

1. 由以上概括性的语言，我们知道这是一个多输入单输出的模型，但是有时也可以是多输出的。如果想要设计的模型具有更好的泛化能力，需要将其设计成模板的形式，而在单片机编程中，通常使用C语言，C语言没有提供模板特性或语法，因此只能仿照模板设计一种阉割之后的模板。
2. 我们发现输入数据和输出数据通常是一个数字量，所以可以使用数组来实现数据的输入，在输出数据时，我们需要给模糊控制API传递一个数据接收缓冲区用于接收解算得到的控制信号数据。
3. 不同系统中的FC通常不是一样的，我们也不能事先为各个系统设计专用或通用的控制算法，需要用户自己编写回调函数实现数据的模糊函数、模糊推理、反模糊化等过程。
4. 为了使用方便，需要以面向对象的思想进行FC的设计，不过我们并不提供对象中设置输入数据寄存器的功能，因为C语言使用结构体实现面向对象并不向方法传递对象的引用。

## 模糊化

模糊化就是将输入的精确值模糊化成为模糊子集，这样就将不同量纲的数据统一成了同一量纲，方便后续的操作。

通常一个模态的数据有一个评判标准，比如100分的试卷，我可以认为其评判准则如下：

| 等级 | 分数 |
| - | - |
| 优秀 | ≥90 |
| 良好 | ≥70 |
| 及格 | ≥60 |
| 不及格 | <60 |

其对应的隶属函数曲线如图所示：

![分数隶属函数曲线](./img/分数隶属度函数曲线.jpg)

可见，当分数取到一个允许的特定值时，可以得到带有4个隶属度元素的隶属度向量，比如当分数为80时，隶属度向量为`[0 0.67 0.67 0]`，这是从“优秀”开始计算的，当然也可以从“不及格”开始排序，显然这个隶属函数是不合适的，为了方便，我就不再修改了。

类似地，我们将其他输入数据进行模糊化，别忘了也要模糊化输出数据，在这你可能就有疑问了，输出数据不是还没有被计算出来吗，为什么要对它进行模糊化呢？
TODO(me)解释为什么需要对输出数据进行模糊化
模糊化输出数据同样要建立一套隶属函数，
TODO(me)完善输出数据模糊化过程

# 参考资料

1. [【入门】智能控制 | 20分钟搞定模糊控制](https://www.bilibili.com/video/BV1LF411B7h6/?share_source=copy_web&vd_source=6cc0d29d53534db0b6fe68e1a43abf47)
2. [【学习笔记】模糊控制算法](http://t.csdnimg.cn/9wnB8)
